{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/raimundege/NextJS/wine-next/app/actions.ts"],"sourcesContent":["'use server';\n\nimport * as mongoDB from \"mongodb\";\nimport { sub } from 'date-fns';\nimport { revalidatePath } from \"next/cache\";\n\nconst client = new mongoDB.MongoClient(\"mongodb://blitz:27017\");\nlet db: mongoDB.Db | null = null;\nlet range: string = \"6hours\";\nlet degree: string = \"fahrenheit\";\n\ninterface Item {\n  time: string;\n  temp: number;\n}\n\nasync function connect() {\n    await client.connect();\n    db = client.db(\"wine\");\n    console.log(\"Connected to MongoDB\");\n}\n\nexport async function getTemps() {\n    if (!db) {\n        await connect();\n    }   \n    var delta = 0;\n    switch (range) {\n        case \"all\": delta = 24 * 365; break;\n        case 'hour': delta = 1; break;\n        case '2hours': delta = 2; break;\n        case '6hours': delta = 6; break;\n        case '12hours': delta = 12; break;\n        case 'day': delta = 24; break;\n        case '2day': delta = 48; break;\n        case 'week': delta = 7 * 24; break;\n        case 'month': delta = 30 * 24; break;\n    }\n    var compare = new Date();\n    // console.log('Today is: ' + compare.toISOString());\n    compare = sub(compare, { hours: delta });\n    var search = { \"time\": { $gt: compare } };\n    // console.log(search);\n    var rawTemps = await db!.collection(\"temps\").find(search, { sort: [[\"time\", \"desc\"]] }).toArray();\n    let temps: Item[] = [];\n    rawTemps.forEach(doc => {\n        doc.time = (doc.time as Date).toISOString();\n        temps.push({time: doc.time, temp: degree == 'celsius' ? doc.value : ((doc.value * 9 / 5) + 32)});\n    });\n    // console.log(temps)\n    console.log(\"Fetched \", temps.length, \"records\");\n    return {temps: temps, degree: degree, range: range};\n}\n\nexport async function setRange(newRange: string) {\n    range = newRange;\n    console.log(\"Range set to \", range);\n    revalidatePath(\"/\");\n}\nexport async function setDegree(newDegree: string) {\n    degree = newDegree;\n    console.log(\"Degree set to \", degree);\n    revalidatePath(\"/\");\n}"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;AACA;;;;;;AAEA,MAAM,SAAS,IAAI,sHAAmB,CAAC;AACvC,IAAI,KAAwB;AAC5B,IAAI,QAAgB;AACpB,IAAI,SAAiB;AAOrB,eAAe;IACX,MAAM,OAAO,OAAO;IACpB,KAAK,OAAO,EAAE,CAAC;IACf,QAAQ,GAAG,CAAC;AAChB;AAEO,eAAe;IAClB,IAAI,CAAC,IAAI;QACL,MAAM;IACV;IACA,IAAI,QAAQ;IACZ,OAAQ;QACJ,KAAK;YAAO,QAAQ,KAAK;YAAK;QAC9B,KAAK;YAAQ,QAAQ;YAAG;QACxB,KAAK;YAAU,QAAQ;YAAG;QAC1B,KAAK;YAAU,QAAQ;YAAG;QAC1B,KAAK;YAAW,QAAQ;YAAI;QAC5B,KAAK;YAAO,QAAQ;YAAI;QACxB,KAAK;YAAQ,QAAQ;YAAI;QACzB,KAAK;YAAQ,QAAQ,IAAI;YAAI;QAC7B,KAAK;YAAS,QAAQ,KAAK;YAAI;IACnC;IACA,IAAI,UAAU,IAAI;IAClB,qDAAqD;IACrD,UAAU,IAAA,yIAAG,EAAC,SAAS;QAAE,OAAO;IAAM;IACtC,IAAI,SAAS;QAAE,QAAQ;YAAE,KAAK;QAAQ;IAAE;IACxC,uBAAuB;IACvB,IAAI,WAAW,MAAM,GAAI,UAAU,CAAC,SAAS,IAAI,CAAC,QAAQ;QAAE,MAAM;YAAC;gBAAC;gBAAQ;aAAO;SAAC;IAAC,GAAG,OAAO;IAC/F,IAAI,QAAgB,EAAE;IACtB,SAAS,OAAO,CAAC,CAAA;QACb,IAAI,IAAI,GAAG,AAAC,IAAI,IAAI,CAAU,WAAW;QACzC,MAAM,IAAI,CAAC;YAAC,MAAM,IAAI,IAAI;YAAE,MAAM,UAAU,YAAY,IAAI,KAAK,GAAI,AAAC,IAAI,KAAK,GAAG,IAAI,IAAK;QAAG;IAClG;IACA,qBAAqB;IACrB,QAAQ,GAAG,CAAC,YAAY,MAAM,MAAM,EAAE;IACtC,OAAO;QAAC,OAAO;QAAO,QAAQ;QAAQ,OAAO;IAAK;AACtD;AAEO,eAAe,SAAS,QAAgB;IAC3C,QAAQ;IACR,QAAQ,GAAG,CAAC,iBAAiB;IAC7B,IAAA,+IAAc,EAAC;AACnB;AACO,eAAe,UAAU,SAAiB;IAC7C,SAAS;IACT,QAAQ,GAAG,CAAC,kBAAkB;IAC9B,IAAA,+IAAc,EAAC;AACnB;;;IAzCsB;IAgCA;IAKA;;AArCA,+OAAA;AAgCA,+OAAA;AAKA,+OAAA","debugId":null}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///Users/raimundege/NextJS/wine-next/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {getTemps as '00859568fc1f613f18f184485b910f9b47fbc62a56'} from 'ACTIONS_MODULE0'\nexport {setRange as '4049ad5e84d3cb88990325cbe4482b37b922797054'} from 'ACTIONS_MODULE0'\nexport {setDegree as '406a2a2be179cfe3eb67b6b88631ee01e4da258561'} from 'ACTIONS_MODULE0'\nexport {setRange as '4049ad5e84d3cb88990325cbe4482b37b922797054'} from 'ACTIONS_MODULE0'\nexport {setDegree as '406a2a2be179cfe3eb67b6b88631ee01e4da258561'} from 'ACTIONS_MODULE0'\nexport {getTemps as '00859568fc1f613f18f184485b910f9b47fbc62a56'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}}]
}